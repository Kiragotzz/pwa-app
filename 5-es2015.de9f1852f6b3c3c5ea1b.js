(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"8oYY":function(n,l,t){"use strict";t.r(l);var e=t("8Y7J");class i{}var s=t("pMnS"),a=t("SVse"),o=t("MKJQ"),u=t("sZkV"),r=t("iInd"),c=t("mrSG"),h=t("H+bZ"),d=t("EnSQ"),p=t("qfBg"),b=t("6mc2"),m=t("Mzne");class g{constructor(n,l,t,e,i,s){this.platform=n,this.api=l,this.data=t,this.user=e,this.tools=i,this.router=s,this.raspinhas=[],this.idx=0,this.raspDisp=0,this.premiosList=[{id:0,valor:0,img:"assets/img/clube/premios/0reais.jpg",message:"N\xe3o foi dessa vez, continue participando!"},{id:10,valor:10,img:"assets/img/clube/premios/10reais.jpg",message:"Voc\xea ganhou R$10 em vale compras!"},{id:15,valor:15,img:"assets/img/clube/premios/15reais.jpg",message:"Voc\xea ganhou R$15 em vale compras!"},{id:20,valor:20,img:"assets/img/clube/premios/20reais.jpg",message:"Voc\xea ganhou R$20 em vale compras!"},{id:25,valor:25,img:"assets/img/clube/premios/25reais.jpg",message:"Voc\xea ganhou R$25 em vale compras!"},{id:99,valor:0,img:"assets/img/clube/premios/imagem.jpg",message:"Voc\xea ganhou um produto!",produto:!0}],this.showImg=!1,this.ios=!1,this.premio={img:"assets/img/clube/premios/padrao.jpg",message:"N\xe3o foi dessa vez, continue participando!"},this.size=0,this.srcCanvas="",this.srcPincel="",this.srcCanvas=this.data.getData("srcCanvas"),this.srcPincel=this.data.getData("srcPincel")}ngOnInit(){this.size=window.innerWidth-32,document.getElementById("js-container").style.width=this.size+"px",document.getElementById("js-container").style.height=this.size+"px"}ionViewDidEnter(){var n={clienteId:this.user.getUsuarioClube()._id,bsm:"ok1"};this.showImg=!1,this.api.clube("listarpremios",n,n=>{this.idx=0;for(let t of n.data)if([0,10].indexOf(t.valor)>=0&&!t.produto){var l=this.premiosList.find(n=>n.id==t.valor);t.img=l.img,t.message=l.message}this.raspinhas=n.data.filter(n=>"raspinha"==n.tipo&&!n.visualizado),this.raspDisp=this.raspinhas.filter(n=>!n.visualizado).length,console.log("[raspinhas] ",this.raspinhas),setTimeout(()=>{this.loadRaspadinha()},50)})}ionViewDidLeave(){console.log("ionViewDidLeave"),this.raspinhas=[]}nextRaspinha(){console.log("nextRaspinha1"),this.raspinhas[this.idx].resgatado?this.idx+1!=this.raspDisp?(this.showImg=!1,this.idx=this.idx+1,console.log("nextRaspinha2"),setTimeout(()=>{console.log("nextRaspinha3"),this.loadRaspadinha()},50)):this.tools.showAlert("","Essa \xe9 sua \xfaltima raspinha!"):this.tools.showAlert("","Utilize essa raspinha primeiro!")}loadRaspadinha(){return c.__awaiter(this,void 0,void 0,(function*(){this.showImg=!1;let n=this;(()=>{document.getElementById("js-container");var l,t,e=document.getElementById("js-canvas"+n.idx),i=e.width,s=e.height,a=e.getContext("2d"),o=new Image,u=new Image;function r(n,l){var t=0,e=0;if(void 0!==l.offsetParent)do{t+=l.offsetLeft,e+=l.offsetTop}while(l=l.offsetParent);return{x:(n.pageX||n.touches[0].clientX)-t,y:(n.pageY||n.touches[0].clientY)-e}}function c(n){l=!0,t=r(n,e)}function h(o){if(l){o.preventDefault();for(var c,h,d,p,b=r(o,e),m=(d=t,p=b,Math.sqrt(Math.pow(p.x-d.x,2)+Math.pow(p.y-d.y,2))),g=function(n,l){return Math.atan2(l.x-n.x,l.y-n.y)}(t,b),f=0;f<m;f++)c=t.x+Math.sin(g)*f-25,h=t.y+Math.cos(g)*f-25,a.globalCompositeOperation="destination-out",a.drawImage(u,c,h);t=b,function(l){if((l=l||0)>60){if(!document.getElementById("js-canvas"+n.idx))return;e.parentNode.removeChild(e),n.api.clube("ativaraspinha",{raspinha:n.raspinhas[n.idx]},l=>(console.log("ativaraspinha: ",l),l.status?(n.raspinhas[n.idx].resgatado=!0,n.user.setUsuarioClube(l.data),n.router.send({cmd:"usuario",usuario:l.data}),void n.tools.showAlert(n.raspinhas[n.idx].premiado?"Parab\xe9ns":"Que pena...",n.premio.message)):void n.tools.showAlert("Falha",l.msg)))}}(function(n){(!n||n<1)&&(n=1);for(var l=a.getImageData(0,0,i,s).data,t=l.length,e=t/n,o=0,u=o=0;u<t;u+=n)0===parseInt(l[u])&&o++;return Math.round(o/e*100)}(32))}}function d(n){l=!1}o.src=n.srcCanvas,o.style.maxWidth="100%",o.onload=()=>{a.drawImage(o,0,0,n.size,n.size),document.querySelectorAll(".raspadinha")[0].style.visibility="visible",this.raspinhas[this.idx].produto&&(this.raspinhas[this.idx].valor="99"),this.premio=this.premiosList.find(n=>n.id==this.raspinhas[this.idx].valor),this.raspinhas[this.idx].produto&&this.raspinhas[this.idx].img&&(this.premio.message=this.raspinhas[this.idx].message,this.premio.img=this.raspinhas[this.idx].img),this.showImg=!0},u.src=n.srcPincel,e.addEventListener("mousedown",c,!1),e.addEventListener("touchstart",c,!1),e.addEventListener("mousemove",h,!1),e.addEventListener("touchmove",h,!1),e.addEventListener("mouseup",d,!1),e.addEventListener("touchend",d,!1)})()}))}}var f=e.pb({encapsulation:0,styles:[[".hidden[_ngcontent-%COMP%]{display:none}.show[_ngcontent-%COMP%]{display:block}.container[_ngcontent-%COMP%]{position:relative;margin:0 auto;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;overflow:hidden}.canvas[_ngcontent-%COMP%]{position:absolute;top:0}.serie[_ngcontent-%COMP%]{text-align:center;color:#009efa;font-weight:700;font-size:1rem;margin-bottom:16px}.raspadinha[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%;text-align:center}.raspadinha[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.teste[_ngcontent-%COMP%]{border:5px solid red}.app-raspinha[_ngcontent-%COMP%]   .buttons-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.app-raspinha[_ngcontent-%COMP%]   .buttons-content[_ngcontent-%COMP%]   .premio-button[_ngcontent-%COMP%]{height:50px;border-radius:10px;flex:1;font-weight:1000;text-align:center;display:flex;flex-direction:column;justify-content:center;align-items:center}.app-raspinha[_ngcontent-%COMP%]   .buttons-content[_ngcontent-%COMP%]   .numerodasorte[_ngcontent-%COMP%]{color:#009efa;border:2px solid #009efa}.app-raspinha[_ngcontent-%COMP%]   .buttons-content[_ngcontent-%COMP%]   .vernumerodasorte[_ngcontent-%COMP%]{background:#f88a2f;color:#fff}.premio-button[_ngcontent-%COMP%] + .premio-button[_ngcontent-%COMP%]{margin-left:16px}"]],data:{}});function v(n){return e.Kb(0,[(n()(),e.rb(0,0,null,null,3,"canvas",[["class","canvas"]],[[8,"id",0],[8,"width",0],[8,"height",0]],null,null,null,null)),e.Gb(512,null,a.t,a.u,[e.r,e.s,e.l,e.C]),e.qb(2,278528,null,0,a.h,[a.t],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e.Fb(3,{hidden:0})],(function(n,l){var t=n(l,3,0,l.component.idx!=l.context.index);n(l,2,0,"canvas",t)}),(function(n,l){var t=l.component;n(l,0,0,"js-canvas"+l.context.index,t.size,t.size)}))}function x(n){return e.Kb(0,[(n()(),e.rb(0,0,null,null,0,"img",[],[[8,"src",4]],null,null,null,null))],null,(function(n,l){n(l,0,0,l.parent.context.$implicit.img)}))}function w(n){return e.Kb(0,[(n()(),e.rb(0,0,null,null,2,"div",[["class",""]],null,null,null,null,null)),(n()(),e.gb(16777216,null,null,1,null,x)),e.qb(2,16384,null,0,a.j,[e.O,e.K],{ngIf:[0,"ngIf"]},null)],(function(n,l){var t=l.component;n(l,2,0,t.idx==l.context.index&&t.showImg)}),null)}function y(n){return e.Kb(0,[(n()(),e.rb(0,0,null,null,1,"div",[["class","serie"]],null,null,null,null,null)),(n()(),e.Jb(1,null,["N\xba de S\xe9rie: ",""]))],null,(function(n,l){var t=l.component;n(l,1,0,t.raspinhas[t.idx].serie)}))}function C(n){return e.Kb(0,[(n()(),e.rb(0,0,null,null,14,"ion-header",[],null,null,null,o.lb,o.p)),e.qb(1,49152,null,0,u.D,[e.h,e.l,e.y],null,null),(n()(),e.rb(2,0,null,0,12,"ion-toolbar",[["color","secondary"]],null,null,null,o.Rb,o.V)),e.qb(3,49152,null,0,u.Bb,[e.h,e.l,e.y],{color:[0,"color"]},null),(n()(),e.rb(4,0,null,0,7,"ion-buttons",[["routerLink","/clube/clube/clube-premios"],["slot","start"]],null,[[null,"click"]],(function(n,l,t){var i=!0;return"click"===l&&(i=!1!==e.Db(n,6).onClick()&&i),"click"===l&&(i=!1!==e.Db(n,7).onClick(t)&&i),i}),o.bb,o.f)),e.qb(5,49152,null,0,u.n,[e.h,e.l,e.y],null,null),e.qb(6,16384,null,0,r.n,[r.m,r.a,[8,null],e.C,e.l],{routerLink:[0,"routerLink"]},null),e.qb(7,737280,null,0,u.Nb,[a.g,u.Ib,e.l,r.m,[2,r.n]],null,null),(n()(),e.rb(8,0,null,0,3,"ion-button",[],null,null,null,o.ab,o.e)),e.qb(9,49152,null,0,u.m,[e.h,e.l,e.y],null,null),(n()(),e.rb(10,0,null,0,1,"ion-icon",[["name","arrow-back-outline"],["slot","icon-only"]],null,null,null,o.mb,o.q)),e.qb(11,49152,null,0,u.E,[e.h,e.l,e.y],{name:[0,"name"]},null),(n()(),e.rb(12,0,null,0,2,"ion-title",[],null,null,null,o.Pb,o.T)),e.qb(13,49152,null,0,u.zb,[e.h,e.l,e.y],null,null),(n()(),e.Jb(-1,0,["Raspinhas"])),(n()(),e.rb(15,0,null,null,24,"ion-content",[["class","app-raspinha"]],null,null,null,o.ib,o.m)),e.qb(16,49152,null,0,u.w,[e.h,e.l,e.y],null,null),(n()(),e.rb(17,0,null,0,22,"ion-card",[],null,null,null,o.fb,o.g)),e.qb(18,49152,null,0,u.o,[e.h,e.l,e.y],null,null),(n()(),e.rb(19,0,null,0,5,"div",[["class","container"],["id","js-container"]],null,null,null,null,null)),(n()(),e.gb(16777216,null,null,1,null,v)),e.qb(21,278528,null,0,a.i,[e.O,e.K,e.r],{ngForOf:[0,"ngForOf"]},null),(n()(),e.rb(22,0,null,null,2,"div",[["class","raspadinha"]],null,null,null,null,null)),(n()(),e.gb(16777216,null,null,1,null,w)),e.qb(24,278528,null,0,a.i,[e.O,e.K,e.r],{ngForOf:[0,"ngForOf"]},null),(n()(),e.rb(25,0,null,0,14,"ion-card-content",[],null,null,null,o.cb,o.h)),e.qb(26,49152,null,0,u.p,[e.h,e.l,e.y],null,null),(n()(),e.gb(16777216,null,0,1,null,y)),e.qb(28,16384,null,0,a.j,[e.O,e.K],{ngIf:[0,"ngIf"]},null),(n()(),e.rb(29,0,null,0,10,"div",[["class","buttons-content"]],null,null,null,null,null)),(n()(),e.rb(30,0,null,null,4,"div",[["class","premio-button numerodasorte"]],null,null,null,null,null)),(n()(),e.rb(31,0,null,null,1,"div",[["style","font-size: 0.7rem"]],null,null,null,null,null)),(n()(),e.Jb(-1,null,["Raspinhas"])),(n()(),e.rb(33,0,null,null,1,"div",[["class",""]],null,null,null,null,null)),(n()(),e.Jb(34,null,["","/",""])),(n()(),e.rb(35,0,null,null,4,"div",[["class","premio-button vernumerodasorte"]],null,[[null,"click"]],(function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.nextRaspinha()&&e),e}),null,null)),(n()(),e.rb(36,0,null,null,3,"div",[["class",""]],null,null,null,null,null)),(n()(),e.Jb(-1,null,["PR\xd3XIMO "])),(n()(),e.rb(38,0,null,null,1,"ion-icon",[["name","chevron-forward-outline"]],null,null,null,o.mb,o.q)),e.qb(39,49152,null,0,u.E,[e.h,e.l,e.y],{name:[0,"name"]},null)],(function(n,l){var t=l.component;n(l,3,0,"secondary"),n(l,6,0,"/clube/clube/clube-premios"),n(l,7,0),n(l,11,0,"arrow-back-outline"),n(l,21,0,t.raspinhas),n(l,24,0,t.raspinhas),n(l,28,0,t.raspinhas[t.idx]&&t.raspinhas[t.idx].serie),n(l,39,0,"chevron-forward-outline")}),(function(n,l){var t=l.component;n(l,34,0,t.idx+1,t.raspDisp)}))}function M(n){return e.Kb(0,[(n()(),e.rb(0,0,null,null,1,"app-clube-raspadinha",[],null,null,null,C,f)),e.qb(1,114688,null,0,g,[u.Kb,h.a,d.a,p.a,b.a,m.a],null,null)],(function(n,l){n(l,1,0)}),null)}var O=e.nb("app-clube-raspadinha",g,M,{},{},[]),P=t("s7LF");class k{}t.d(l,"ClubeRaspadinhaPageModuleNgFactory",(function(){return I}));var I=e.ob(i,[],(function(n){return e.Ab([e.Bb(512,e.k,e.Z,[[8,[s.a,O]],[3,e.k],e.w]),e.Bb(4608,a.l,a.k,[e.t,[2,a.y]]),e.Bb(4608,P.l,P.l,[]),e.Bb(4608,u.c,u.c,[e.y,e.g]),e.Bb(4608,u.Hb,u.Hb,[u.c,e.k,e.q]),e.Bb(4608,u.Lb,u.Lb,[u.c,e.k,e.q]),e.Bb(1073742336,a.b,a.b,[]),e.Bb(1073742336,P.k,P.k,[]),e.Bb(1073742336,P.e,P.e,[]),e.Bb(1073742336,u.Db,u.Db,[]),e.Bb(1073742336,r.p,r.p,[[2,r.u],[2,r.m]]),e.Bb(1073742336,k,k,[]),e.Bb(1073742336,i,i,[]),e.Bb(1024,r.k,(function(){return[[{path:"",component:g}]]}),[])])}))}}]);